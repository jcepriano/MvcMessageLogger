@model User
@{
    ViewData["Title"] = "Statistics";
}
@{
    List<User> usersOrdered = ViewData["UsersOrderedByMessageCount"] as List<User>;
}
@{
    var userMessages = ViewData["userMessages"] as List<User>;
}
@{
    var allMessages = ViewData["AllMessages"] as List<string>;
}
@{
    var mostCommon = ViewData["mostCommonWord"] as string[];
}
@{
    var word = ViewData["commonKey"];
}

<h1>Statistics</h1>

<p>Total Number of Users: @ViewData["TotalUserCount"]</p>
<p>Total Number of Messages: @ViewData["TotalMessageCount"]</p>

@if (ViewData["UserWithMostMessages"] != null)
{
    <h2>User with Most Messages</h2>
    <p>User: @((ViewData["UserWithMostMessages"] as User)?.Name)</p>
    <p>Number of Messages: @((ViewData["UserWithMostMessages"] as User)?.Messages.Count)</p>
}
else
{
    <p>No users with messages found.</p>
}

<h2>Users Ordered By Amount of Messages</h2>
@foreach(var user in usersOrdered)
{
    if(user.Messages.Count() > 0)
    {
        <p>@user.Name | Messages: @user.Messages.Count()</p>

    }
    else
    {
        <p>@user.Name | No Messages</p>
    }
}

<h2>Most common word used overall</h2>
@if (ViewData["MostCommonWord"] != null)
{
    <p>Word: @ViewData["MostCommonWord"]</p>
    <p>Count: @ViewData["MostCommonWordCount"]</p>
}
else
{
    <p>No messages found.</p>
}

<!--Common word used per user-->
<h2>Most common word per user</h2>
@foreach (var user in userMessages)
{
    if(user.Messages.Any())
    {
        if (mostCommon != null && mostCommon.Count() > 1)
        {
            <p>@user.Name | @word</p>
        }
        else
        {
            <p>@user.Name | Has messages but no common words.</p>
        }
    }
    else
    {
        <p>@user.Name | No messages found.</p>
    }
}

<a asp-action="Index">All Users</a>